<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Serie II - Envío de Mensajes</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/messaje.css">
</head>
<body>
    <div class="login-container message-container">
        <div class="card">
            <!-- Vista sin autenticación -->
            <div id="noAuthView" class="d-none">
                <div class="card-body no-auth">
                    <div class="lock-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <h3>Acceso Denegado</h3>
                    <a href="/views/login.html" class="btn btn-login">
                        <i class="fas fa-arrow-left me-2"></i>
                        Volver al Login
                    </a>
                </div>
            </div>

            <!-- Vista con autenticación -->
            <div id="authView" class="d-none">
                <div class="card-header">
                    <div class="logo-circle">
                        <i class="fas fa-paper-plane"></i>
                    </div>
                    <h1>Serie II</h1>
                    <p>Envío de Mensajes Protegido</p>
                </div>
                
                <div class="card-body">
                    <!-- Información del usuario -->
                    <div class="alert alert-info d-flex align-items-center mb-4" role="alert">
                        <i class="fas fa-user-check me-3" style="font-size: 24px;"></i>
                        <div>
                            <strong>Usuario autenticado:</strong> <span id="usuarioActual" style="color: #0d6efd; font-weight: 600;"></span>
                        </div>
                    </div>

                    <!-- Formulario de mensaje -->
                    <div class="mb-3">
                        <label class="form-label">
                            <i class="fas fa-envelope me-2"></i>Mensaje
                        </label>
                        <textarea 
                            class="form-control mensaje-area" 
                            id="contenidoMensaje" 
                            placeholder="Escriba su mensaje aquí..."
                            maxlength="500"
                        ></textarea>
                        <div class="char-counter" id="charCounter">0 / 500 caracteres</div>
                    </div>

                    <!-- Alerta de error -->
                    <div id="errorAlert" class="alert alert-danger d-none" role="alert">
                        <i class="fas fa-exclamation-circle me-2"></i>
                        <span id="errorMessage"></span>
                    </div>

                    <!-- Alerta de éxito -->
                    <div id="successAlert" class="alert alert-success d-none" role="alert">
                        <i class="fas fa-check-circle me-2"></i>
                        <span id="successMessage"></span>
                    </div>

                    <!-- Botones -->
                    <div class="d-flex gap-2">
                        <button class="btn btn-login flex-grow-1" id="enviarBtn" onclick="enviarMensaje()">
                            <i class="fas fa-paper-plane me-2"></i>
                            <span id="btnText">Enviar Mensaje</span>
                        </button>
                        <button class="btn btn-logout" onclick="cerrarSesion()">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>

                    <!-- Historial de mensajes enviados -->
                    <div id="historialMensajes" class="mt-4"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/messaje.js"></script>
</body>
</html>