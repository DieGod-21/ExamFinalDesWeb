<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Autenticación - Examen Final</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div class="login-container">
        <div class="card">
            <div id="loginView">
                <div class="card-header">
                    <div class="logo-circle">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h1>Examen Final</h1>
                    <p>Serie I: Sistema de Autenticación</p>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label class="form-label">
                            <i class="fas fa-user me-2"></i>Usuario
                        </label>
                        <div class="input-group">
                            <span class="input-group-text">
                                <i class="fas fa-user"></i>
                            </span>
                            <input type="text" class="form-control" id="username" placeholder="Ej: dvasquezs4">
                        </div>
                        <div class="helper-text">
                            <i class="fas fa-info-circle me-1"></i>
                            Solo la parte antes de @miumg.edu.gt
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">
                            <i class="fas fa-lock me-2"></i>Contraseña
                        </label>
                        <div class="input-group">
                            <span class="input-group-text">
                                <i class="fas fa-lock"></i>
                            </span>
                            <input type="password" class="form-control" id="password" placeholder="Ingrese su contraseña">
                            <span class="input-group-text eye-icon" onclick="togglePassword()">
                                <i class="fas fa-eye" id="eyeIcon"></i>
                            </span>
                        </div>
                    </div>

                    <div id="errorAlert" class="alert alert-danger d-none" role="alert">
                        <i class="fas fa-exclamation-circle me-2"></i>
                        <span id="errorMessage"></span>
                    </div>

                    <button class="btn btn-login" id="loginBtn" onclick="handleLogin()">
                        <i class="fas fa-sign-in-alt me-2"></i>
                        <span id="btnText">Iniciar Sesión</span>
                    </button>

                    <div class="password-hint">
                        <i class="fas fa-key me-2"></i>
                        Contraseña de prueba: <strong>123456a</strong>
                    </div>
                </div>
            </div>

            <div id="successView" class="d-none">
                <div class="card-body success-container">
                    <div class="success-icon">
                        <i class="fas fa-check"></i>
                    </div>
                    <h2 class="mb-2">¡Autenticación Exitosa!</h2>
                    <p class="text-muted mb-3">Serie I completada correctamente</p>
                    <span class="badge-success">
                        <i class="fas fa-check-circle me-1"></i>
                        Token almacenado en sessionStorage
                    </span>

                    <div class="info-box mt-4">
                        <div class="row mb-2">
                            <div class="col-5 info-label">Usuario:</div>
                            <div class="col-7 info-value text-end" id="displayUsername"></div>
                        </div>
                        <div class="row mb-2">
                            <div class="col-5 info-label">Hora de login:</div>
                            <div class="col-7 info-value text-end" id="displayTime"></div>
                        </div>
                        <div class="row">
                            <div class="col-12 info-label mb-2">Token (primeros 50 caracteres):</div>
                            <div class="col-12">
                                <div class="token-box" id="displayToken"></div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-info mt-3" role="alert">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Listo para Serie II</strong><br>
                        <small>El token está guardado y disponible para las siguientes pruebas</small>
                    </div>

                    <button class="btn btn-logout" onclick="handleLogout()">
                        <i class="fas fa-sign-out-alt me-2"></i>
                        Cerrar Sesión
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/login.js"></script>
</body>
</html>